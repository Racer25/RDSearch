var ConnectionProvider = require("../dao/ConnectionProvider.js");
var mysql = require('mysql');

var getTextualInformationByOrphanetID = function(orphanetID, callback)
{
    var connection=ConnectionProvider.getConnection();

    var sql = "SELECT * FROM textualInformation WHERE orphanetID=?";
    var inserts = [orphanetID];
    sql = mysql.format(sql, inserts);

    connection.query(sql, function (error, results, fields) {
        if (error) throw error;
        callback(results);
    });
}

var addOrModifyTextualInformationFromOrphanet = function(textualInformation, callback)
{
    var connection=ConnectionProvider.getConnection();

    var sql = "INSERT INTO textualInformation(idTextualInformation, title, content, orphanetID) "+
        "VALUES(?, ?, ?, ?) ON DUPLICATE KEY "+ 
        "UPDATE title=?, content=?, orphanetID=?";
    var inserts = [textualInformation.id, textualInformation.title, textualInformation.content, textualInformation.orphanetID, 
                  textualInformation.title, textualInformation.content, textualInformation.orphanetID];
    sql = mysql.format(sql, inserts);

    connection.query(sql, function (error, results, fields) {
        if (error) throw error;
        callback();
    });
}

exports.getTextualInformationByOrphanetID=getTextualInformationByOrphanetID;
exports.addOrModifyTextualInformationFromOrphanet=addOrModifyTextualInformationFromOrphanet;