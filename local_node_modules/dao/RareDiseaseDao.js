var ConnectionProvider = require("../dao/ConnectionProvider.js");
var mysql = require('mysql');

var addOrModifyRareDisease = function(rareDisease, i)
{
    var connection=ConnectionProvider.getConnection();
    
    var sql = "INSERT INTO rareDisease(orphanetID, name, description) "+
        "VALUES(?, ?, ?) ON DUPLICATE KEY "+ 
    "UPDATE name=?, description=?";
    var inserts = [rareDisease.orphanetID, rareDisease.name, rareDisease.description, rareDisease.name, rareDisease.description];
    sql = mysql.format(sql, inserts);

    connection.query(sql, function (error, results, fields) {
        if (error) throw error;
        console.log("Request "+i+" finished");
    });
}

var addOrModifyRareDiseases = function(rareDiseases)
{    
    for(var i = 0; i < rareDiseases.length; i++)
    {
        addOrModifyRareDisease(rareDiseases[i],  i);
    }
}


exports.addOrModifyRareDisease=addOrModifyRareDisease;
exports.addOrModifyRareDiseases=addOrModifyRareDiseases;
//exports.modifyRareDisease=modifyRareDisease;
//exports.deleteRareDisease=deleteRareDisease;