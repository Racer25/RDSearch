var ConnectionProvider=require("./ConnectionProvider");
var mysql = require('mysql');

var addPublication = function(publication)
{
    var connection=ConnectionProvider.getConnection();

    var sql = "INSERT INTO publication(idPublication, title, abstract, authors, doi, lastUpdateDate) "+
        "VALUES(?, ?, ?, ?, ?, ?) ON DUPLICATE KEY UPDATE title=?, abstract=?, authors=?, doi=?, lastUpdateDate=?";
    var inserts = [publication.id, publication.title, publication.abstract, publication.authors,
        publication.doi, publication.lastUpdateDate,
        publication.title, publication.abstract, publication.authors,
        publication.doi, publication.lastUpdateDate];
    sql = mysql.format(sql, inserts);

    connection.query(sql, function (error, results, fields) {
        if (error) throw error;

        //console.log('The solution is: ', results[0].solution);
    });
    connection.end();
};

exports.addPublication=addPublication;