var ConnectionProvider = require("../dao/ConnectionProvider.js");
var mysql = require('mysql');

var getSymptom = function(name, callback)
{
    var connection=ConnectionProvider.getConnection();

    var sql = "SELECT * FROM symptom WHERE name=?";
    var inserts = [name];
    sql = mysql.format(sql, inserts);
    console.log(sql);

    connection.query(sql, function (error, results, fields) {
        if (error) throw error;
        callback(results[0]);
    });
};

var getSymptoms = function(callback)
{
    var connection=ConnectionProvider.getConnection();

    var sql = "SELECT * FROM symptom ORDER BY name";
    var inserts = [];
    sql = mysql.format(sql, inserts);

    connection.query(sql, function (error, results, fields) {
        if (error) throw error;
        callback(results);
    });
};

var addOrModifySymptom = function(symptom, callback)
{
    var connection=ConnectionProvider.getConnection();

    var sql = "INSERT IGNORE INTO symptom(name) VALUES(?)";
    var inserts = [symptom.name];
    sql = mysql.format(sql, inserts);

    connection.query(sql, function (error, results, fields) {
        if (error) throw error;
        callback(results.insertId);
    });
};

exports.getSymptom=getSymptom;
exports.getSymptoms=getSymptoms;
exports.addOrModifySymptom=addOrModifySymptom;