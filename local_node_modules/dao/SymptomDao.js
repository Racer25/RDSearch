var ConnectionProvider = require("../dao/ConnectionProvider.js");
var mysql = require('mysql');

var getSymptom = function(idSymptom, callback)
{
    var connection=ConnectionProvider.getConnection();

    var sql = "SELECT * FROM symptom WHERE idSymptom=?";
    var inserts = [idSymptom];
    sql = mysql.format(sql, inserts);

    connection.query(sql, function (error, results, fields) {
        if (error) throw error;
        callback(results[0]);
    });
};

var getSymptoms = function(callback)
{
    var connection=ConnectionProvider.getConnection();

    var sql = "SELECT * FROM symptom ORDER BY idSymptom";
    var inserts = [];
    sql = mysql.format(sql, inserts);

    connection.query(sql, function (error, results, fields) {
        if (error) throw error;
        callback(results);
    });
};

var addOrModifySymptom = function(symptom, callback)
{
    var connection=ConnectionProvider.getConnection();

    var sql = "INSERT INTO symptom(idSymptom, name) "+
        "VALUES(?, ?) ON DUPLICATE KEY "+
        "UPDATE name=?";
    var inserts = [symptom.idSymptom, symptom.name, symptom.name];
    sql = mysql.format(sql, inserts);

    connection.query(sql, function (error, results, fields) {
        if (error) throw error;
        callback();
    });
};

exports.getSymptom=getSymptom;
exports.getSymptoms=getSymptoms;
exports.addOrModifySymptom=addOrModifySymptom;